---
title: "Plane Distances & Squint Angle Diagnostics"
author: "Tina Rashid Jafari"
vignette: >
  %\VignetteIndexEntry{Plane Distances & Squint Angle Diagnostics}
  %\VignetteEngine{quarto::html}
  %\VignetteEncoding{UTF-8}
---

```{r, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  message=FALSE, 
  warning=FALSE
)
```

## Overview

This vignette covers three diagnostics for tours and projection pursuit:
  
* `distanceDist()` — all pairwise distances between input planes.
* `distanceToSp()` — distances from each input plane to a special/optimal plane.
* `squintAngleEstimate()` — distribution of squint angles: how far a random start must rotate toward the optimal view before an index exceeds a cutoff.

```{r}
library(spinebil)   
library(ggplot2)
```


## What the Function Does

`distanceDist(planes, nn = FALSE)`

* **Input:** `planes` = list of projection basis (each p×2).
* **Work:** computes tourr::proj\_dist() for every pair of planes.
* **Note:** `nn` is a placeholder (nearest-neighbour only) and not yet implemented.
* **Output:** numeric vector of all pairwise distances.

 `distanceToSp(planes, specialPlane)`

* **Input:** list of planes and one special plane (e.g., the “optimal” view).
* **Work:** computes proj\_dist() from each plane to the special plane.
* **Output:** numeric vector of distances, one per input plane.

`squintAngleEstimate(data, indexF, cutoff, structurePlane, n = 100, stepSize = 0.01)`

* **Goal:** for each of `n` random starts, move along an interpolated planned tour toward the `structurePlane` until the index exceeds `cutoff`. Record the remaining distance (angle) to the structure.
* **Output:** numeric vector (length `n`) of squint-angle estimates.

## Function usage

```r
# All pairwise distances between planes:
distanceDist(planes)

# Distances to a known/special plane:
distanceToSp(planes, specialPlane)

# Squint angle estimates:
squintAngleEstimate(
  data, indexF, cutoff, structurePlane,
  n = 100, stepSize = 0.01
)
```


## Example Usage

  
### A) Pairwise distance between input planes
  
```{r}
planes1 <- purrr::rerun(10, tourr::basis_random(5))
planes2 <- purrr::rerun(10, tourr::basis_random(10))
d1 <- distanceDist(planes1)
d2 <- distanceDist(planes2)
d <- tibble::tibble(dist=c(d1, d2), dim=c(rep(5,length(d1)),rep(10,length(d2))))
ggplot2::ggplot(d) + ggplot2::geom_boxplot(ggplot2::aes(factor(dim), dist))

```


### B) Distances to a special plane

```{r}
planes <- purrr::rerun(10, tourr::basis_random(5))
specialPlane <- basisMatrix(1,2,5)
distanceToSp(planes, specialPlane)

```

### C) Squint angle estimate

```{r}
data <- spiralData(4, 50)
indexF <- scagIndex("stringy")
cutoff <- 0.7
structurePlane <- basisMatrix(3, 4, 4)
angles1 <- squintAngleEstimate(data, indexF, cutoff, structurePlane, n = 1)
angles1
```


## Return value

* **`distanceDist()`** returns a numeric vector of all pairwise distances between input planes.
* **`distanceToSp()`** returns a numeric vector of distances to the provided special plane (same length as `planes`).
* **`squintAngleEstimate()`** returns a numeric vector (length `n`) of squint-angle estimates under the given index and cutoff.

