---
title: "Estimating a Noise Threshold for Projection–Pursuit Indices"
author: "Tina Rashid Jafari"
vignette: >
  %\VignetteIndexEntry{Estimating a Noise Threshold for Projection–Pursuit Indices}
  %\VignetteEngine{quarto::html}
  %\VignetteEncoding{UTF-8}
---

```{r, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  message=FALSE, 
  warning=FALSE
)
```

## Overview

`ppi_noise_threshold()` estimates the 95th percentile of a projection pursuit index (PPI) under synthetic noise. This gives you a null threshold: if an observed index on real data exceeds this value, it may indicate non-random structure.

```{r}
library(tidyverse)
library(spinebil)
```

The function supports different noise types via `noise_gen()` (e.g., Gaussian, $t$-distributed, Cauchy, microstructure) and lets you set the number of simulations and sample size per simulation.


## What the Function Does

`ppi_noise_threshold(index_fun, n_sim = 100, n_obs = 500, noise_type = "gaussian", noise_level = 0.01, seed = NULL)`

* Generates noise pairs `(x, y)` repeatedly (`n_sim` times), each of length `n_obs`, using `noise_gen(type = noise_type, level = noise_level)`.
* Computes the index for every simulated pair via `index_fun`.
  
* Returns the 95th percentile (`quantile(..., 0.95)`) of all simulated index values.



## Function usage

```r
ppi_noise_threshold(
  index_fun,
  n_sim = 100,
  n_obs = 500,
  noise_type  = "gaussian",
  noise_level = 0.01,
  seed = NULL
)
```

**Arguments :**

* **`index_fun`**: a function that returns a single numeric value. 
* **`n_sim`**: number of simulations.
* **`n_obs`**: sample size per simulation.
* **`noise_type` / `noise_level`**: passed through to `noise_gen()` to control the distribution and its scale.
* **`seed`**: for reproducibility.


## Example Usage

  
```{r}
thr <- ppi_noise_threshold(
  index_fun   = scagIndex("stringy"),
  noise_type  = "cauchy",
  noise_level = 0.1,
  n_sim       = 10,
  n_obs       = 100
)
thr
```


## Return value

* **`ppi_noise_threshold()`** returns a single numeric: estimated 95th percentile of the index under the specified noise model.
